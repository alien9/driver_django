<ul ngbNav #nav="ngbNav" class="nav-tabs">
    <li [ngbNavItem]="k.key" *ngFor="let k of schema['definitions']|keyvalue|orderBy">
        <a ngbNavLink *ngIf="!k.value.multiple">{{k.value.title|translate}}</a>
        <a ngbNavLink *ngIf="k.value.multiple">{{k.value.plural_title|translate}}</a>
        <ng-template ngbNavContent>
            <div class="small-map" *ngIf="k.value.details">
                <div class="input-map" leaflet [leafletLayers]=layers [leafletLayersControl]="layersControl" [leafletOptions]="options"></div>
            </div>
            <ul class="list-group list-group-flush" *ngIf="k.value.details">
                <li class="list-group-item">
                    <span i18n>{{'Latitude'|translate}}</span>: {{record['geom'].coordinates[0]}}
                </li>
                <li class="list-group-item">
                    <span i18n>{{'Longitude'|translate}}</span>: {{record['geom'].coordinates[1]}}
                </li>
                <li class="list-group-item">
                    <span i18n>{{'Location'|translate}}</span>: {{record["location_text"] }}
                </li>
                <li class="list-group-item">
                    <span i18n>{{'Date and time'|translate}}</span>: {{record["occurred_from"] }}
                </li>
                <li class="list-group-item">
                    <span i18n>{{'Weather'|translate}}</span>: {{record["weather"] }}
                </li>
                <li class="list-group-item">
                    <span i18n>{{'Light'|translate}}</span>: {{record["light"] }}
                </li>
            </ul>
            <div *ngIf="!k.value.multiple">
                <ul class="list-group list-group-flush" *ngFor="let f of k.value.properties|keyvalue|display|orderBy">
                    <li class="list-group-item">{{f.key|translate}}: {{record['data']|dict_dump:k.key:null:f.key|format:f.value}}
                        <img [src]="record['data'][k.key][f.key]" *ngIf="f.value.media && record['data'][k.key] && record['data'][k.key][f.key]">
                    </li>
                </ul>

            </div>
            <div *ngIf="k.value.multiple">

                <div class="card" *ngFor="let kk of record['data'][k.key]; let i = index">
                    <div class="card-body">
                        <h5 class="card-title">{{k.value.title|translate}}</h5>
                        <h6 class="card-subtitle mb-2 text-muted">{{k.value.description|translate}}</h6>

                        <ul class="list-group list-group-flush" *ngFor="let f of k.value.properties|keyvalue|display|orderBy">
                            <li class="list-group-item">
                                {{f.key}}: {{record['data']|dict_dump:k.key:i:f.key|format:f.value}}
                                <img [src]="record['data'][k.key][f.key]" *ngIf="f.value.media && record['data'][k.key] && record['data'][k.key][f.key]">
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </ng-template>
    </li>
</ul>

<div [ngbNavOutlet]="nav" class="mt-2"></div>